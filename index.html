<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Easy Habit Tracker</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ÔøΩÔøΩ</text></svg>">
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-dark: #45a049;
            --secondary-color: #2196F3;
            --warning-color: #FF9800;
            --danger-color: #f44336;
            --success-color: #4CAF50;
            --text-primary: #333;
            --text-secondary: #666;
            --bg-primary: #f5f7fa;
            --bg-card: #ffffff;
            --border-color: #e0e0e0;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .current-date {
            font-size: 1.2rem;
            margin-top: 15px;
            background: rgba(255,255,255,0.2);
            display: inline-block;
            padding: 8px 20px;
            border-radius: 25px;
        }

        /* Navigation Tabs */
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            background: var(--bg-card);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: var(--shadow);
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: var(--bg-primary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .tab-btn:hover {
            background: #e0e0e0;
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Card Styles */
        .card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .card h2 {
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Progress Overview Section */
        .progress-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .progress-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .progress-card h3 {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .progress-card .label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 5px;
        }

        /* Progress Bar */
        .progress-bar-container {
            margin: 15px 0;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Habit List */
        .habit-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .habit-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .habit-item:hover {
            background: #e8e8e8;
        }

        .habit-item.completed {
            background: #e8f5e9;
        }

        .habit-checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: var(--primary-color);
        }

        .habit-name {
            flex: 1;
            font-weight: 500;
        }

        .habit-item.completed .habit-name {
            text-decoration: line-through;
            color: var(--text-secondary);
        }

        .habit-category {
            font-size: 0.8rem;
            padding: 4px 10px;
            border-radius: 15px;
            background: var(--secondary-color);
            color: white;
        }

        .habit-streak {
            font-size: 0.9rem;
            color: var(--warning-color);
            font-weight: bold;
        }

        .habit-delete {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 1.2rem;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .habit-delete:hover {
            opacity: 1;
        }

        /* Add Habit Form */
        .add-habit-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .add-habit-form input,
        .add-habit-form select {
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            flex: 1;
            min-width: 150px;
        }

        .add-habit-form input:focus,
        .add-habit-form select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .add-habit-form button {
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background 0.3s ease;
        }

        .add-habit-form button:hover {
            background: var(--primary-dark);
        }

        /* Calendar Grid */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 15px;
        }

        .calendar-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: var(--secondary-color);
            color: white;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: var(--bg-primary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-day:hover {
            background: #e0e0e0;
        }

        .calendar-day.today {
            border: 2px solid var(--primary-color);
            font-weight: bold;
        }

        .calendar-day.completed {
            background: var(--success-color);
            color: white;
        }

        .calendar-day.partial {
            background: var(--warning-color);
            color: white;
        }

        .calendar-day.other-month {
            opacity: 0.3;
        }

        .calendar-day .date-num {
            font-weight: bold;
        }

        .calendar-day .completion-rate {
            font-size: 0.7rem;
        }

        /* Wellness Section */
        .wellness-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .wellness-card {
            background: var(--bg-primary);
            border-radius: 10px;
            padding: 20px;
        }

        .wellness-card h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .wellness-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        .wellness-input input {
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            width: 80px;
            font-size: 1.2rem;
            text-align: center;
        }

        .wellness-input input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .mood-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mood-btn {
            font-size: 2rem;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-card);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mood-btn:hover {
            transform: scale(1.1);
        }

        .mood-btn.selected {
            border-color: var(--primary-color);
            background: #e8f5e9;
        }

        /* Stats Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .chart-container {
            height: 200px;
            background: var(--bg-primary);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: flex-end;
            gap: 5px;
        }

        .bar {
            flex: 1;
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px 5px 0 0;
            min-width: 20px;
            transition: height 0.5s ease;
            position: relative;
        }

        .bar::after {
            content: attr(data-value);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            white-space: nowrap;
        }

        .bar-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        /* Ranking List */
        .ranking-list {
            counter-reset: ranking;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .ranking-item::before {
            counter-increment: ranking;
            content: "#" counter(ranking);
            font-weight: bold;
            color: var(--primary-color);
            min-width: 30px;
        }

        .ranking-item:first-child::before {
            content: "ü•á";
        }

        .ranking-item:nth-child(2)::before {
            content: "ü•à";
        }

        .ranking-item:nth-child(3)::before {
            content: "ü•â";
        }

        .ranking-name {
            flex: 1;
        }

        .ranking-percent {
            font-weight: bold;
            color: var(--success-color);
        }

        /* Actions Section */
        .actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background: #1976D2;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        /* Settings Section */
        .settings-grid {
            display: grid;
            gap: 20px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 10px;
        }

        .setting-label {
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--danger-color);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .tabs {
                justify-content: center;
            }

            .tab-btn {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .add-habit-form {
                flex-direction: column;
            }

            .add-habit-form input,
            .add-habit-form select,
            .add-habit-form button {
                width: 100%;
            }

            .calendar-header {
                font-size: 0.7rem;
                padding: 5px;
            }

            .calendar-day {
                font-size: 0.75rem;
            }
        }

        /* Print Styles */
        @media print {
            .tabs, .add-habit-form, .actions, .btn {
                display: none;
            }

            .card {
                break-inside: avoid;
            }
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            margin-top: 40px;
        }

        footer a {
            color: var(--primary-color);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <h1>üìä Easy Habit Tracker</h1>
        <p>Build better habits, one day at a time</p>
        <div class="current-date" id="currentDate"></div>
    </header>

    <div class="container">
        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="daily">üìÖ Daily Tracker</button>
            <button class="tab-btn" data-tab="calendar">üìÜ Calendar View</button>
            <button class="tab-btn" data-tab="wellness">üíö Wellness</button>
            <button class="tab-btn" data-tab="stats">üìà Statistics</button>
            <button class="tab-btn" data-tab="settings">‚öôÔ∏è Settings</button>
        </div>

        <!-- Progress Overview -->
        <div class="progress-overview">
            <div class="progress-card">
                <h3>Today's Progress</h3>
                <div class="value" id="todayProgress">0%</div>
                <div class="label"><span id="todayCompleted">0</span> of <span id="todayTotal">0</span> habits</div>
            </div>
            <div class="progress-card">
                <h3>Weekly Progress</h3>
                <div class="value" id="weeklyProgress">0%</div>
                <div class="label">This week</div>
            </div>
            <div class="progress-card">
                <h3>Monthly Progress</h3>
                <div class="value" id="monthlyProgress">0%</div>
                <div class="label">This month</div>
            </div>
            <div class="progress-card">
                <h3>Current Streak</h3>
                <div class="value" id="currentStreak">0</div>
                <div class="label">days in a row</div>
            </div>
        </div>

        <!-- Daily Tracker Tab -->
        <div class="tab-content active" id="daily">
            <div class="card">
                <h2>‚ûï Add New Habit</h2>
                <form class="add-habit-form" id="addHabitForm">
                    <input type="text" id="habitName" placeholder="Enter habit name..." required>
                    <select id="habitCategory">
                        <option value="health">üè• Health & Fitness</option>
                        <option value="learning">üß† Learning</option>
                        <option value="productivity">üíº Productivity</option>
                        <option value="mindfulness">üßò Mindfulness</option>
                        <option value="social">üë• Social</option>
                        <option value="creative">üé® Creative</option>
                        <option value="home">üè† Home</option>
                        <option value="other">üìå Other</option>
                    </select>
                    <button type="submit">Add Habit</button>
                </form>
            </div>

            <div class="card">
                <h2>‚úÖ Today's Habits</h2>
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="dailyProgressBar" style="width: 0%"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progressLabel">0 completed</span>
                        <span id="progressPercent">0%</span>
                    </div>
                </div>
                <div class="habit-list" id="habitList">
                    <!-- Habits will be dynamically added here -->
                </div>
            </div>
        </div>

        <!-- Calendar View Tab -->
        <div class="tab-content" id="calendar">
            <div class="card">
                <h2>üìÜ Monthly Overview</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <button class="btn btn-secondary" id="prevMonth">‚Üê Previous</button>
                    <h3 id="calendarMonth"></h3>
                    <button class="btn btn-secondary" id="nextMonth">Next ‚Üí</button>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <div class="calendar-header">Sun</div>
                    <div class="calendar-header">Mon</div>
                    <div class="calendar-header">Tue</div>
                    <div class="calendar-header">Wed</div>
                    <div class="calendar-header">Thu</div>
                    <div class="calendar-header">Fri</div>
                    <div class="calendar-header">Sat</div>
                </div>
            </div>
        </div>

        <!-- Wellness Tab -->
        <div class="tab-content" id="wellness">
            <div class="card">
                <h2>üíö Self-Check Zone</h2>
                <div class="wellness-grid">
                    <div class="wellness-card">
                        <h3>üò¥ Sleep Tracking</h3>
                        <div class="wellness-input">
                            <input type="number" id="sleepHours" min="0" max="24" step="0.5" placeholder="0">
                            <span>hours slept last night</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="sleepProgress" style="width: 0%"></div>
                            </div>
                            <div class="progress-text">
                                <span>Goal: 8 hours</span>
                                <span id="sleepPercent">0%</span>
                            </div>
                        </div>
                        <p style="margin-top: 10px; color: var(--text-secondary);">
                            Average this week: <strong id="avgSleep">0</strong> hours
                        </p>
                    </div>

                    <div class="wellness-card">
                        <h3>üíß Water Intake</h3>
                        <div class="wellness-input">
                            <input type="number" id="waterGlasses" min="0" max="20" placeholder="0">
                            <span>glasses today</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar">
                                <div class="progress-bar-fill" id="waterProgress" style="width: 0%"></div>
                            </div>
                            <div class="progress-text">
                                <span>Goal: 8 glasses</span>
                                <span id="waterPercent">0%</span>
                            </div>
                        </div>
                        <p style="margin-top: 10px; color: var(--text-secondary);">
                            Average this week: <strong id="avgWater">0</strong> glasses
                        </p>
                    </div>

                    <div class="wellness-card">
                        <h3>üòä Today's Mood</h3>
                        <div class="mood-buttons">
                            <button class="mood-btn" data-mood="amazing">üòÅ</button>
                            <button class="mood-btn" data-mood="good">üòä</button>
                            <button class="mood-btn" data-mood="okay">üòê</button>
                            <button class="mood-btn" data-mood="sad">üòî</button>
                            <button class="mood-btn" data-mood="bad">üòû</button>
                        </div>
                        <p style="margin-top: 15px; color: var(--text-secondary);">
                            Current mood: <strong id="currentMood">Not set</strong>
                        </p>
                    </div>

                    <div class="wellness-card">
                        <h3>üìù Daily Reflection</h3>
                        <textarea id="dailyReflection" placeholder="What are you grateful for today? What went well? What could be better?" style="width: 100%; height: 100px; padding: 10px; border: 2px solid var(--border-color); border-radius: 8px; resize: vertical; font-family: inherit;"></textarea>
                        <button class="btn btn-primary" style="margin-top: 10px;" id="saveReflection">Save Reflection</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Tab -->
        <div class="tab-content" id="stats">
            <div class="stats-grid">
                <div class="card">
                    <h2>üìä Weekly Performance</h2>
                    <div class="chart-container" id="weeklyChart">
                        <!-- Bar chart will be generated here -->
                    </div>
                </div>

                <div class="card">
                    <h2>üèÜ Top 10 Most Consistent Habits</h2>
                    <div class="ranking-list" id="habitRanking">
                        <!-- Rankings will be generated here -->
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üìà Overall Statistics</h2>
                <div class="progress-overview">
                    <div class="progress-card">
                        <h3>Total Habits</h3>
                        <div class="value" id="totalHabits">0</div>
                        <div class="label">active habits</div>
                    </div>
                    <div class="progress-card">
                        <h3>Total Completions</h3>
                        <div class="value" id="totalCompletions">0</div>
                        <div class="label">all time</div>
                    </div>
                    <div class="progress-card">
                        <h3>Best Streak</h3>
                        <div class="value" id="bestStreak">0</div>
                        <div class="label">days</div>
                    </div>
                    <div class="progress-card">
                        <h3>Days Tracked</h3>
                        <div class="value" id="daysTracked">0</div>
                        <div class="label">total days</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings">
            <div class="card">
                <h2>‚öôÔ∏è Settings</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">Daily Sleep Goal</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem;">Hours of sleep per night</div>
                        </div>
                        <input type="number" id="sleepGoal" value="8" min="4" max="12" style="width: 80px; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; text-align: center;">
                    </div>
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">Daily Water Goal</div>
                            <div style="color: var(--text-secondary); font-size: 0.9rem;">Glasses of water per day</div>
                        </div>
                        <input type="number" id="waterGoal" value="8" min="4" max="20" style="width: 80px; padding: 8px; border: 2px solid var(--border-color); border-radius: 5px; text-align: center;">
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üíæ Data Management</h2>
                <div class="actions">
                    <button class="btn btn-primary" id="exportData">üì• Export Data</button>
                    <button class="btn btn-secondary" id="importData">üì§ Import Data</button>
                    <button class="btn btn-danger" id="clearData">üóëÔ∏è Clear All Data</button>
                </div>
                <input type="file" id="importFile" accept=".json" style="display: none;">
                <p style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                    Your data is stored locally in your browser. Export regularly to keep a backup!
                </p>
            </div>

            <div class="card">
                <h2>üìñ Quick Start Guide</h2>
                <div style="line-height: 1.8;">
                    <p><strong>1. Add Habits:</strong> Use the form above to add habits you want to track daily.</p>
                    <p><strong>2. Check Off:</strong> Click the checkbox next to each habit when completed.</p>
                    <p><strong>3. Track Wellness:</strong> Log your sleep, water intake, and mood in the Wellness tab.</p>
                    <p><strong>4. Review Progress:</strong> Check the Statistics tab to see your consistency rankings.</p>
                    <p><strong>5. Export Data:</strong> Save your data regularly using the Export button above.</p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>üìä Easy Habit Tracker | Build better habits, one day at a time</p>
        <p>Data stored locally in your browser ‚Ä¢ <a href="https://github.com/iganga360/Easy-Habit-Tracker" target="_blank">View on GitHub</a></p>
    </footer>

    <script>
        // ============================================
        // Easy Habit Tracker - JavaScript Application
        // ============================================

        // Utility Functions
        const getDateKey = (date = new Date()) => {
            return date.toISOString().split('T')[0];
        };

        const formatDate = (date) => {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        };

        // Data Management
        class HabitTracker {
            constructor() {
                this.loadData();
                this.currentMonth = new Date();
                this.init();
            }

            loadData() {
                const savedData = localStorage.getItem('habitTrackerData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    this.habits = parsed.habits || [];
                    this.completions = parsed.completions || {};
                    this.wellness = parsed.wellness || {};
                    this.settings = parsed.settings || { sleepGoal: 8, waterGoal: 8 };
                    this.stats = parsed.stats || { bestStreak: 0, totalCompletions: 0 };
                } else {
                    this.habits = [];
                    this.completions = {};
                    this.wellness = {};
                    this.settings = { sleepGoal: 8, waterGoal: 8 };
                    this.stats = { bestStreak: 0, totalCompletions: 0 };
                    this.addDefaultHabits();
                }
            }

            addDefaultHabits() {
                const defaults = [
                    { name: 'Exercise (30 min)', category: 'health' },
                    { name: 'Drink 8 glasses of water', category: 'health' },
                    { name: 'Read for 20 minutes', category: 'learning' },
                    { name: 'Meditate (5 min)', category: 'mindfulness' },
                    { name: 'Journal / Reflection', category: 'mindfulness' },
                    { name: 'Make your bed', category: 'home' },
                    { name: 'Healthy breakfast', category: 'health' },
                    { name: 'No phone after 9 PM', category: 'productivity' }
                ];
                defaults.forEach(h => this.addHabit(h.name, h.category, false));
                this.saveData();
            }

            saveData() {
                const data = {
                    habits: this.habits,
                    completions: this.completions,
                    wellness: this.wellness,
                    settings: this.settings,
                    stats: this.stats
                };
                localStorage.setItem('habitTrackerData', JSON.stringify(data));
            }

            addHabit(name, category, save = true) {
                const habit = {
                    id: Date.now() + Math.random(),
                    name,
                    category,
                    createdAt: getDateKey()
                };
                this.habits.push(habit);
                if (save) {
                    this.saveData();
                    this.renderHabits();
                    this.updateProgress();
                    showNotification('Habit added successfully!', 'success');
                }
                return habit;
            }

            deleteHabit(id) {
                this.habits = this.habits.filter(h => h.id !== id);
                this.saveData();
                this.renderHabits();
                this.updateProgress();
                showNotification('Habit deleted', 'success');
            }

            toggleCompletion(habitId) {
                const today = getDateKey();
                if (!this.completions[today]) {
                    this.completions[today] = [];
                }

                const index = this.completions[today].indexOf(habitId);
                if (index > -1) {
                    this.completions[today].splice(index, 1);
                } else {
                    this.completions[today].push(habitId);
                    this.stats.totalCompletions++;
                }

                this.saveData();
                this.renderHabits();
                this.updateProgress();
            }

            isCompleted(habitId, date = getDateKey()) {
                return this.completions[date]?.includes(habitId) || false;
            }

            getCompletionRate(date = getDateKey()) {
                const completed = this.completions[date]?.length || 0;
                const total = this.habits.length;
                return total > 0 ? Math.round((completed / total) * 100) : 0;
            }

            getWeeklyProgress() {
                const today = new Date();
                let totalCompleted = 0;
                let totalPossible = 0;

                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = getDateKey(date);
                    totalCompleted += this.completions[dateKey]?.length || 0;
                    totalPossible += this.habits.length;
                }

                return totalPossible > 0 ? Math.round((totalCompleted / totalPossible) * 100) : 0;
            }

            getMonthlyProgress() {
                const today = new Date();
                const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
                const currentDay = today.getDate();
                let totalCompleted = 0;
                let totalPossible = 0;

                for (let i = 1; i <= currentDay; i++) {
                    const date = new Date(today.getFullYear(), today.getMonth(), i);
                    const dateKey = getDateKey(date);
                    totalCompleted += this.completions[dateKey]?.length || 0;
                    totalPossible += this.habits.length;
                }

                return totalPossible > 0 ? Math.round((totalCompleted / totalPossible) * 100) : 0;
            }

            getCurrentStreak() {
                let streak = 0;
                const today = new Date();

                for (let i = 0; i < 365; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = getDateKey(date);
                    const rate = this.getCompletionRate(dateKey);

                    if (rate >= 50) {
                        streak++;
                    } else if (i > 0) {
                        break;
                    }
                }

                if (streak > this.stats.bestStreak) {
                    this.stats.bestStreak = streak;
                    this.saveData();
                }

                return streak;
            }

            getHabitConsistency(habitId) {
                let completed = 0;
                let total = 0;
                const today = new Date();

                for (let i = 0; i < 30; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = getDateKey(date);
                    if (this.isCompleted(habitId, dateKey)) {
                        completed++;
                    }
                    total++;
                }

                return total > 0 ? Math.round((completed / total) * 100) : 0;
            }

            getTopHabits(count = 10) {
                return this.habits
                    .map(h => ({
                        ...h,
                        consistency: this.getHabitConsistency(h.id)
                    }))
                    .sort((a, b) => b.consistency - a.consistency)
                    .slice(0, count);
            }

            saveWellness(type, value) {
                const today = getDateKey();
                if (!this.wellness[today]) {
                    this.wellness[today] = {};
                }
                this.wellness[today][type] = value;
                this.saveData();
            }

            getWellness(type, date = getDateKey()) {
                return this.wellness[date]?.[type] || null;
            }

            getWeeklyWellnessAvg(type) {
                const today = new Date();
                let total = 0;
                let count = 0;

                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = getDateKey(date);
                    const value = this.getWellness(type, dateKey);
                    if (value !== null && !isNaN(value)) {
                        total += parseFloat(value);
                        count++;
                    }
                }

                return count > 0 ? (total / count).toFixed(1) : 0;
            }

            // Export/Import
            exportData() {
                const data = {
                    habits: this.habits,
                    completions: this.completions,
                    wellness: this.wellness,
                    settings: this.settings,
                    stats: this.stats,
                    exportedAt: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `habit-tracker-backup-${getDateKey()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showNotification('Data exported successfully!', 'success');
            }

            importData(file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        this.habits = data.habits || [];
                        this.completions = data.completions || {};
                        this.wellness = data.wellness || {};
                        this.settings = data.settings || { sleepGoal: 8, waterGoal: 8 };
                        this.stats = data.stats || { bestStreak: 0, totalCompletions: 0 };
                        this.saveData();
                        this.renderAll();
                        showNotification('Data imported successfully!', 'success');
                    } catch (err) {
                        showNotification('Error importing data. Please check the file format.', 'error');
                    }
                };
                reader.readAsText(file);
            }

            clearData() {
                if (confirm('Are you sure you want to clear all data? This cannot be undone!')) {
                    localStorage.removeItem('habitTrackerData');
                    this.habits = [];
                    this.completions = {};
                    this.wellness = {};
                    this.settings = { sleepGoal: 8, waterGoal: 8 };
                    this.stats = { bestStreak: 0, totalCompletions: 0 };
                    this.renderAll();
                    showNotification('All data cleared', 'success');
                }
            }

            // Rendering
            renderHabits() {
                const container = document.getElementById('habitList');
                const today = getDateKey();

                if (this.habits.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No habits yet. Add your first habit above!</p>';
                    return;
                }

                container.innerHTML = this.habits.map(habit => {
                    const isCompleted = this.isCompleted(habit.id);
                    const streak = this.getHabitConsistency(habit.id);
                    const categoryColors = {
                        health: '#4CAF50',
                        learning: '#9C27B0',
                        productivity: '#FF9800',
                        mindfulness: '#00BCD4',
                        social: '#E91E63',
                        creative: '#FF5722',
                        home: '#795548',
                        other: '#607D8B'
                    };

                    return `
                        <div class="habit-item ${isCompleted ? 'completed' : ''}" data-id="${habit.id}">
                            <input type="checkbox" class="habit-checkbox" ${isCompleted ? 'checked' : ''}>
                            <span class="habit-name">${this.escapeHtml(habit.name)}</span>
                            <span class="habit-category" style="background: ${categoryColors[habit.category] || categoryColors.other}">${habit.category}</span>
                            <span class="habit-streak">üî• ${streak}%</span>
                            <button class="habit-delete" title="Delete habit">√ó</button>
                        </div>
                    `;
                }).join('');

                // Add event listeners
                container.querySelectorAll('.habit-checkbox').forEach(cb => {
                    cb.addEventListener('change', (e) => {
                        const id = parseFloat(e.target.closest('.habit-item').dataset.id);
                        this.toggleCompletion(id);
                    });
                });

                container.querySelectorAll('.habit-delete').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = parseFloat(e.target.closest('.habit-item').dataset.id);
                        if (confirm('Delete this habit?')) {
                            this.deleteHabit(id);
                        }
                    });
                });
            }

            updateProgress() {
                const today = getDateKey();
                const completed = this.completions[today]?.length || 0;
                const total = this.habits.length;
                const percent = total > 0 ? Math.round((completed / total) * 100) : 0;

                document.getElementById('todayProgress').textContent = percent + '%';
                document.getElementById('todayCompleted').textContent = completed;
                document.getElementById('todayTotal').textContent = total;
                document.getElementById('dailyProgressBar').style.width = percent + '%';
                document.getElementById('progressLabel').textContent = `${completed} completed`;
                document.getElementById('progressPercent').textContent = percent + '%';

                document.getElementById('weeklyProgress').textContent = this.getWeeklyProgress() + '%';
                document.getElementById('monthlyProgress').textContent = this.getMonthlyProgress() + '%';
                document.getElementById('currentStreak').textContent = this.getCurrentStreak();
            }

            renderCalendar() {
                const grid = document.getElementById('calendarGrid');
                const monthLabel = document.getElementById('calendarMonth');
                const year = this.currentMonth.getFullYear();
                const month = this.currentMonth.getMonth();

                monthLabel.textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

                // Clear previous days (keep headers)
                const headers = grid.querySelectorAll('.calendar-header');
                grid.innerHTML = '';
                headers.forEach(h => grid.appendChild(h.cloneNode(true)));

                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const today = new Date();
                const todayKey = getDateKey();

                // Add empty cells for days before the first day
                for (let i = 0; i < firstDay; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'calendar-day other-month';
                    grid.appendChild(cell);
                }

                // Add days
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month, day);
                    const dateKey = getDateKey(date);
                    const rate = this.getCompletionRate(dateKey);
                    const isToday = dateKey === todayKey;

                    const cell = document.createElement('div');
                    cell.className = 'calendar-day';
                    if (isToday) cell.classList.add('today');
                    if (rate >= 80) cell.classList.add('completed');
                    else if (rate >= 50) cell.classList.add('partial');

                    cell.innerHTML = `
                        <span class="date-num">${day}</span>
                        <span class="completion-rate">${rate}%</span>
                    `;

                    grid.appendChild(cell);
                }
            }

            renderWellness() {
                const today = getDateKey();

                // Sleep
                const sleep = this.getWellness('sleep');
                if (sleep) {
                    document.getElementById('sleepHours').value = sleep;
                    const sleepGoal = this.settings.sleepGoal;
                    const sleepPercent = Math.min(100, Math.round((sleep / sleepGoal) * 100));
                    document.getElementById('sleepProgress').style.width = sleepPercent + '%';
                    document.getElementById('sleepPercent').textContent = sleepPercent + '%';
                }
                document.getElementById('avgSleep').textContent = this.getWeeklyWellnessAvg('sleep');

                // Water
                const water = this.getWellness('water');
                if (water) {
                    document.getElementById('waterGlasses').value = water;
                    const waterGoal = this.settings.waterGoal;
                    const waterPercent = Math.min(100, Math.round((water / waterGoal) * 100));
                    document.getElementById('waterProgress').style.width = waterPercent + '%';
                    document.getElementById('waterPercent').textContent = waterPercent + '%';
                }
                document.getElementById('avgWater').textContent = this.getWeeklyWellnessAvg('water');

                // Mood
                const mood = this.getWellness('mood');
                document.querySelectorAll('.mood-btn').forEach(btn => {
                    btn.classList.toggle('selected', btn.dataset.mood === mood);
                });
                document.getElementById('currentMood').textContent = mood ? this.getMoodLabel(mood) : 'Not set';

                // Reflection
                const reflection = this.getWellness('reflection');
                if (reflection) {
                    document.getElementById('dailyReflection').value = reflection;
                }
            }

            getMoodLabel(mood) {
                const labels = {
                    amazing: 'üòÅ Amazing',
                    good: 'üòä Good',
                    okay: 'üòê Okay',
                    sad: 'üòî Sad',
                    bad: 'üòû Not Good'
                };
                return labels[mood] || mood;
            }

            renderStats() {
                // Weekly chart
                const chartContainer = document.getElementById('weeklyChart');
                chartContainer.innerHTML = '';
                const today = new Date();
                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateKey = getDateKey(date);
                    const rate = this.getCompletionRate(dateKey);

                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    bar.style.height = Math.max(5, rate) + '%';
                    bar.setAttribute('data-value', rate + '%');
                    bar.innerHTML = `<span class="bar-label">${days[date.getDay()]}</span>`;
                    chartContainer.appendChild(bar);
                }

                // Top habits ranking
                const rankingContainer = document.getElementById('habitRanking');
                const topHabits = this.getTopHabits(10);

                if (topHabits.length === 0) {
                    rankingContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No habits yet</p>';
                } else {
                    rankingContainer.innerHTML = topHabits.map(h => `
                        <div class="ranking-item">
                            <span class="ranking-name">${this.escapeHtml(h.name)}</span>
                            <span class="ranking-percent">${h.consistency}%</span>
                        </div>
                    `).join('');
                }

                // Overall stats
                document.getElementById('totalHabits').textContent = this.habits.length;
                document.getElementById('totalCompletions').textContent = this.stats.totalCompletions;
                document.getElementById('bestStreak').textContent = this.stats.bestStreak;

                // Days tracked
                const daysTracked = Object.keys(this.completions).length;
                document.getElementById('daysTracked').textContent = daysTracked;
            }

            renderAll() {
                this.renderHabits();
                this.updateProgress();
                this.renderCalendar();
                this.renderWellness();
                this.renderStats();
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            init() {
                // Update current date
                document.getElementById('currentDate').textContent = formatDate(new Date());

                // Initialize settings inputs
                document.getElementById('sleepGoal').value = this.settings.sleepGoal;
                document.getElementById('waterGoal').value = this.settings.waterGoal;

                // Initial render
                this.renderAll();

                // Setup event listeners
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Tab navigation
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        btn.classList.add('active');
                        document.getElementById(btn.dataset.tab).classList.add('active');

                        // Refresh content when switching tabs
                        if (btn.dataset.tab === 'calendar') this.renderCalendar();
                        if (btn.dataset.tab === 'stats') this.renderStats();
                        if (btn.dataset.tab === 'wellness') this.renderWellness();
                    });
                });

                // Add habit form
                document.getElementById('addHabitForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('habitName').value.trim();
                    const category = document.getElementById('habitCategory').value;
                    if (name) {
                        this.addHabit(name, category);
                        document.getElementById('habitName').value = '';
                    }
                });

                // Calendar navigation
                document.getElementById('prevMonth').addEventListener('click', () => {
                    this.currentMonth.setMonth(this.currentMonth.getMonth() - 1);
                    this.renderCalendar();
                });

                document.getElementById('nextMonth').addEventListener('click', () => {
                    this.currentMonth.setMonth(this.currentMonth.getMonth() + 1);
                    this.renderCalendar();
                });

                // Wellness inputs
                document.getElementById('sleepHours').addEventListener('change', (e) => {
                    const value = parseFloat(e.target.value);
                    if (!isNaN(value)) {
                        this.saveWellness('sleep', value);
                        this.renderWellness();
                    }
                });

                document.getElementById('waterGlasses').addEventListener('change', (e) => {
                    const value = parseInt(e.target.value);
                    if (!isNaN(value)) {
                        this.saveWellness('water', value);
                        this.renderWellness();
                    }
                });

                document.querySelectorAll('.mood-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.saveWellness('mood', btn.dataset.mood);
                        this.renderWellness();
                    });
                });

                document.getElementById('saveReflection').addEventListener('click', () => {
                    const reflection = document.getElementById('dailyReflection').value.trim();
                    this.saveWellness('reflection', reflection);
                    showNotification('Reflection saved!', 'success');
                });

                // Settings
                document.getElementById('sleepGoal').addEventListener('change', (e) => {
                    this.settings.sleepGoal = parseInt(e.target.value);
                    this.saveData();
                    this.renderWellness();
                });

                document.getElementById('waterGoal').addEventListener('change', (e) => {
                    this.settings.waterGoal = parseInt(e.target.value);
                    this.saveData();
                    this.renderWellness();
                });

                // Data management
                document.getElementById('exportData').addEventListener('click', () => this.exportData());
                document.getElementById('importData').addEventListener('click', () => {
                    document.getElementById('importFile').click();
                });
                document.getElementById('importFile').addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.importData(e.target.files[0]);
                    }
                });
                document.getElementById('clearData').addEventListener('click', () => this.clearData());
            }
        }

        // Notification function
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize the app
        const tracker = new HabitTracker();
    </script>
</body>
</html>
